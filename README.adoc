= Cladistics.jl

**Provably Correct Phylogenetic Analysis**

_Where tree construction and character evolution are mathematically guaranteed._

== What is Cladistics.jl?

Cladistics.jl is a **next-generation phylogenetic analysis framework** that combines:

- **Compile-time verification** -- Ensures tree construction and bootstrap support are correct before runtime.
- **Formal guarantees** -- Mathematical proofs about tree properties and character evolution.
- **High performance** -- Optimized for large datasets and complex tree inference.
- **Julia elegance** -- Express phylogenetic models as clear, mathematical specifications.

[source,julia]
----
using Cladistics

# Define a simple UPGMA tree construction
alignment = read_fasta("sequences.fa")
tree = upgma(alignment)

# Bootstrap support with formal guarantees
bootstrap_support = bootstrap(tree, alignment, n=1000)
@ensure all(bootstrap_support .>= 0) && all(bootstrap_support .<= 100)
----

== Features

=== Compile-Time Tree Validation
Cladistics.jl catches errors at compile time, not after hours of computation.

[source,julia]
----
# Invalid alignment: Compile error in milliseconds
@cladistic InvalidTree begin
    alignment :: Alignment{DNA, 10, 500}  # 10 taxa, 500 sites
    tree = nj(alignment)  # COMPILE ERROR: "Alignment length mismatch for NJ"
end
----

=== Formal Verification of Tree Properties
Verify properties like monophyly, branch lengths, and bootstrap consistency.

[source,julia]
----
@cladistic SafeTree begin
    alignment :: Alignment{DNA, 10, 500}
    tree = upgma(alignment)
    @ensure is_bifurcating(tree)  # Guaranteed binary tree
    @prove ∀branch. length(branch) > 0  # No zero-length branches
end
----

=== Support for Multiple Methods
- UPGMA, Neighbor-Joining (NJ), and Maximum Parsimony (MP)
- Bootstrap and jackknife support
- Character evolution mapping

[source,julia]
----
# Compare methods
upgma_tree = upgma(alignment)
nj_tree = nj(alignment)
mp_tree = mp(alignment, outgroup="Outgroup_Taxon")
----

=== High Performance
- Optimized C/Rust backends for large datasets
- Parallelized bootstrap and jackknife resampling
- Memory-efficient data structures

[source,julia]
----
# Use Rust backend for 2-3x speedup
fast_tree = upgma(alignment, backend=:rust)
----

== Quick Start

=== Installation
[source,julia]
----
using Pkg
Pkg.add("Cladistics")
----

=== Hello Phylogeny
[source,julia]
----
using Cladistics

# Load alignment
alignment = read_fasta("example.fa")

# Build a tree
tree = nj(alignment)

# Calculate bootstrap support
support = bootstrap(tree, alignment, n=100)

# Visualize
plot(tree, support)
----

=== Using the @cladistic DSL
[source,julia]
----
@cladistic MyAnalysis begin
    alignment :: Alignment{DNA, 10, 500}
    tree = upgma(alignment)
    @ensure is_rooted(tree)
    @ensure n_leaves(tree) == 10
end
----

== Why Cladistics.jl?

=== The Problem
Phylogenetic analysis is foundational for:
- Evolutionary biology
- Epidemiology
- Drug discovery
- Conservation genetics

Yet traditional tools allow silent errors in tree construction and support calculation.

=== The Solution
Cladistics.jl **guarantees correctness**:
| Issue               | Traditional Tools | Cladistics.jl       |
|---------------------|-------------------|---------------------|
| Invalid alignment   | Silent failure    | Compile error       |
| Negative branch lengths | Undetected     | Guaranteed impossible |
| Incorrect bootstrap | Wrong results     | Proven bounds       |

== Project Structure
[source]
----
Cladistics.jl/
├── src/
│   ├── types/          # Alignment and tree types
│   ├── methods/        # UPGMA, NJ, MP implementations
│   ├── verification/   # @ensure, @prove macros
│   ├── io/             # FASTA, Newick, Nexus I/O
│   └── backends/       # Julia/C/Rust implementations
├── rust/               # Performance backend
├── test/               # Unit and integration tests
├── examples/           # Tutorials and workflows
└── docs/               # Documentation
----

== Roadmap
- ✅ **v0.1**: Core methods (UPGMA, NJ, MP), basic verification
- ❏ **v0.2**: Advanced proofs, GPU acceleration
- ❏ **v0.3**: Integration with BEAST, RevBayes
- ❏ **v1.0**: FDA/EMBL-EBI submission support

== Acknowledgments
Cladistics.jl builds on:
- Phylip, PAUP*, RAxML, IQ-TREE
- Julia’s type system and multiple dispatch
- Rust for performance-critical sections
